{% extends 'library_app/base.html' %}
{% block content %}

<style>
/* Page title */
.dashboard-title{
    font-size: 32px;
    font-weight: 700;
    color: #ffffff;
    background: linear-gradient(90deg, #e81c1c, #4a1fd8);
    padding: 12px 22px;
    border-radius: 10px;
    margin-bottom: 24px;
}

/* Cards */
.dashboard-card {
    border-radius: 16px;
    border: none;
    background: #ffffff;
    box-shadow: 0 12px 35px rgba(0,0,0,0.08);
}

/* Section headers */
.section-title {
    font-weight: 600;
    margin-bottom: 12px;
    color: #34495e;
}

/* Profile info */
.profile-box p {
    margin-bottom: 6px;
    font-size: 15px;
}

/* Tables */
.table {
    margin-bottom: 0;
}

.table thead th {
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 0.4px;
}

.table tbody td {
    vertical-align: middle;
    font-size: 15px;
}

/* Fine highlight */
.fine-amount {
    font-weight: 600;
    color: #dc3545;
}

/* Empty text */
.empty-text {
    font-size: 15px;
}

/* Logout */
.logout-btn {
    margin-top: 16px;
}
</style>

<h3 class="mb-4 dashboard-title">Member Dashboard</h3>

<!-- Profile -->
<div class="card p-4 mb-4 dashboard-card profile-box">
  <h5 class="section-title">Profile</h5>
  <p>
    <strong>Name:</strong> {{ profile.full_name }} <br>
    <strong>Card Number:</strong> {{ profile.card_number }}
  </p>
</div>

<!-- Active Books -->
<div class="card p-4 mb-4 dashboard-card">
  <h5 class="section-title">Currently Issued Books</h5>

  {% if active %}
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>Book</th>
        <th>Issued On</th>
        <th>Due Date</th>
        <th>Fine</th>
      </tr>
    </thead>
    <tbody>
      {% for i in active %}
      <tr>
        <td>{{ i.book.title }}</td>
        <td>{{ i.issue_date }}</td>
        <td>{{ i.due_date }}</td>
        <td>
          {% if i.current_fine > 0 %}
            <span class="fine-amount">₹{{ i.current_fine }}</span>
          {% else %}
            ₹0
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p class="text-muted empty-text">No books currently issued.</p>
  {% endif %}
</div>

<!-- History -->
<div class="card p-4 dashboard-card">
  <h5 class="section-title">Returned Books History</h5>

  {% if history %}
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>Book</th>
        <th>Issued</th>
        <th>Returned</th>
        <th>Fine</th>
      </tr>
    </thead>
    <tbody>
      {% for h in history %}
      <tr>
        <td>{{ h.book.title }}</td>
        <td>{{ h.issue_date }}</td>
        <td>{{ h.return_date }}</td>
        <td>
          {% if h.fine_amount > 0 %}
            <span class="fine-amount">₹{{ h.fine_amount }}</span>
          {% else %}
            ₹0
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p class="text-muted empty-text">No history available.</p>
  {% endif %}
</div>

<a href="{% url 'member_logout' %}" 
   class="btn btn-danger btn-sm float-end logout-btn">
   Logout
</a>

{% endblock %}
